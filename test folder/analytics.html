<div class="section-header">
    <h1 class="section-title">
        <i class="fas fa-chart-bar"></i>
        Analytics & Reports
    </h1>
    <p class="section-subtitle">Detailed insights and analytics for your complaint management system.</p>
</div>

<!-- Time Range Selector -->
<div class="filter-bar">
    <div class="filter-group">
        <label class="filter-label">Time Range:</label>
        <select class="filter-select" id="time-range">
            <option value="7">Last 7 days</option>
            <option value="30" selected>Last 30 days</option>
            <option value="90">Last 3 months</option>
            <option value="365">Last year</option>
            <option value="custom">Custom Range</option>
        </select>
    </div>
    <div class="filter-group" id="custom-date-range" style="display: none;">
        <label class="filter-label">From:</label>
        <input type="date" id="date-from" class="filter-input">
        <label class="filter-label">To:</label>
        <input type="date" id="date-to" class="filter-input">
    </div>
    <button class="filter-btn" data-action="generate-report">
        <i class="fas fa-file-pdf"></i>
        Generate Report
    </button>
    <button class="filter-btn" data-action="export-analytics">
        <i class="fas fa-download"></i>
        Export Data
    </button>
</div>

<!-- Key Metrics Overview -->
<div class="stats-grid">
    <div class="stat-card primary">
        <div class="stat-icon">
            <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
            <div class="stat-number" id="avg-resolution-time">-</div>
            <div class="stat-label">Avg. Resolution Time</div>
            <div class="stat-change positive">
                <i class="fas fa-arrow-down"></i>
                <span>-15% improvement</span>
            </div>
        </div>
    </div>

    <div class="stat-card success">
        <div class="stat-icon">
            <i class="fas fa-percentage"></i>
        </div>
        <div class="stat-content">
            <div class="stat-number" id="resolution-rate">-</div>
            <div class="stat-label">Resolution Rate</div>
            <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span>+8% from last month</span>
            </div>
        </div>
    </div>

    <div class="stat-card warning">
        <div class="stat-icon">
            <i class="fas fa-star"></i>
        </div>
        <div class="stat-content">
            <div class="stat-number" id="satisfaction-score">-</div>
            <div class="stat-label">Satisfaction Score</div>
            <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span>+12% this quarter</span>
            </div>
        </div>
    </div>

    <div class="stat-card info">
        <div class="stat-icon">
            <i class="fas fa-chart-line"></i>
        </div>
        <div class="stat-content">
            <div class="stat-number" id="trend-percentage">-</div>
            <div class="stat-label">Monthly Trend</div>
            <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span>Growing</span>
            </div>
        </div>
    </div>
</div>

<!-- Charts Grid -->
<div class="charts-section">
    <div class="chart-card large">
        <div class="chart-header">
            <h3>
                <i class="fas fa-chart-line"></i>
                Complaints Trend Over Time
            </h3>
            <div class="chart-actions">
                <button class="table-btn" data-action="export-chart" data-chart="trend">
                    <i class="fas fa-download"></i>
                    Export
                </button>
                <button class="table-btn" data-action="fullscreen-chart" data-chart="trend">
                    <i class="fas fa-expand"></i>
                    Fullscreen
                </button>
            </div>
        </div>
        <div class="chart-container">
            <canvas id="complaints-trend-chart" width="800" height="400"></canvas>
        </div>
        <div class="chart-legend" id="trend-legend">
            <!-- Legend will be populated by Chart.js -->
        </div>
    </div>

    <div class="chart-card">
        <div class="chart-header">
            <h3>
                <i class="fas fa-chart-pie"></i>
                Status Distribution
            </h3>
            <div class="chart-actions">
                <button class="table-btn" data-action="export-chart" data-chart="status">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>
        <div class="chart-container">
            <canvas id="status-distribution-chart" width="400" height="400"></canvas>
        </div>
        <div class="chart-stats" id="status-stats">
            <!-- Status statistics will be populated here -->
        </div>
    </div>
</div>

<!-- Secondary Charts -->
<div class="charts-section">
    <div class="chart-card">
        <div class="chart-header">
            <h3>
                <i class="fas fa-chart-bar"></i>
                Complaint Types
            </h3>
            <div class="chart-actions">
                <button class="table-btn" data-action="export-chart" data-chart="types">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>
        <div class="chart-container">
            <canvas id="types-chart" width="400" height="300"></canvas>
        </div>
    </div>

    <div class="chart-card">
        <div class="chart-header">
            <h3>
                <i class="fas fa-stopwatch"></i>
                Resolution Time Analysis
            </h3>
            <div class="chart-actions">
                <button class="table-btn" data-action="export-chart" data-chart="resolution">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>
        <div class="chart-container">
            <canvas id="resolution-time-chart" width="400" height="300"></canvas>
        </div>
    </div>

    <div class="chart-card">
        <div class="chart-header">
            <h3>
                <i class="fas fa-calendar-alt"></i>
                Daily Activity Heatmap
            </h3>
            <div class="chart-actions">
                <button class="table-btn" data-action="export-chart" data-chart="heatmap">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>
        <div class="chart-container">
            <div id="activity-heatmap" class="heatmap-container">
                <!-- Heatmap will be rendered here -->
            </div>
        </div>
    </div>

    <div class="chart-card">
        <div class="chart-header">
            <h3>
                <i class="fas fa-users-cog"></i>
                Department Performance
            </h3>
            <div class="chart-actions">
                <button class="table-btn" data-action="export-chart" data-chart="department">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>
        <div class="chart-container">
            <canvas id="department-performance-chart" width="400" height="300"></canvas>
        </div>
    </div>
</div>

<!-- Detailed Analytics Tables -->
<div class="analytics-tables">
    <div class="table-container">
        <div class="table-header">
            <h3>
                <i class="fas fa-trophy"></i>
                Top Performing Categories
            </h3>
            <div class="table-actions">
                <button class="table-btn" data-action="export-table" data-table="performance">
                    <i class="fas fa-download"></i>
                    Export
                </button>
            </div>
        </div>
        <table class="modern-table" id="performance-table">
            <thead>
                <tr>
                    <th>Category</th>
                    <th>Total Complaints</th>
                    <th>Avg. Resolution Time</th>
                    <th>Resolution Rate</th>
                    <th>Satisfaction Score</th>
                    <th>Trend</th>
                </tr>
            </thead>
            <tbody id="performance-tbody">
                <!-- Data will be populated dynamically -->
            </tbody>
        </table>
    </div>

    <div class="table-container">
        <div class="table-header">
            <h3>
                <i class="fas fa-exclamation-triangle"></i>
                Problem Areas
            </h3>
            <div class="table-actions">
                <button class="table-btn" data-action="export-table" data-table="problems">
                    <i class="fas fa-download"></i>
                    Export
                </button>
            </div>
        </div>
        <table class="modern-table" id="problems-table">
            <thead>
                <tr>
                    <th>Issue</th>
                    <th>Frequency</th>
                    <th>Impact Level</th>
                    <th>Avg. Resolution Time</th>
                    <th>Recommended Action</th>
                </tr>
            </thead>
            <tbody id="problems-tbody">
                <!-- Data will be populated dynamically -->
            </tbody>
        </table>
    </div>
</div>

<!-- Advanced Analytics -->
<div class="advanced-analytics">
    <div class="analytics-card">
        <div class="analytics-header">
            <h3>
                <i class="fas fa-brain"></i>
                Predictive Analysis
            </h3>
            <span class="beta-badge">BETA</span>
        </div>
        <div class="analytics-content">
            <div class="prediction-item">
                <div class="prediction-label">Expected complaints next week:</div>
                <div class="prediction-value" id="predicted-complaints">-</div>
            </div>
            <div class="prediction-item">
                <div class="prediction-label">Resource requirement forecast:</div>
                <div class="prediction-value" id="resource-forecast">-</div>
            </div>
            <div class="prediction-item">
                <div class="prediction-label">Peak activity prediction:</div>
                <div class="prediction-value" id="peak-prediction">-</div>
            </div>
        </div>
    </div>

    <div class="analytics-card">
        <div class="analytics-header">
            <h3>
                <i class="fas fa-lightbulb"></i>
                AI Insights
            </h3>
            <span class="ai-badge">AI</span>
        </div>
        <div class="analytics-content">
            <div class="insight-list" id="ai-insights">
                <!-- AI-generated insights will be populated here -->
            </div>
        </div>
    </div>
</div>

<!-- Report Generation Modal -->
<div class="modal-overlay" id="report-modal">
    <div class="modal-container large">
        <div class="modal-header">
            <h3 class="modal-title">Generate Analytics Report</h3>
            <button class="modal-close" data-modal="report-modal">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <form id="report-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Report Type</label>
                        <select id="report-type" class="form-control">
                            <option value="summary">Executive Summary</option>
                            <option value="detailed">Detailed Analysis</option>
                            <option value="department">Department Breakdown</option>
                            <option value="trend">Trend Analysis</option>
                            <option value="custom">Custom Report</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Time Period</label>
                        <select id="report-period" class="form-control">
                            <option value="last_week">Last Week</option>
                            <option value="last_month">Last Month</option>
                            <option value="last_quarter">Last Quarter</option>
                            <option value="last_year">Last Year</option>
                            <option value="custom">Custom Period</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Format</label>
                        <select id="report-format" class="form-control">
                            <option value="pdf">PDF Document</option>
                            <option value="excel">Excel Spreadsheet</option>
                            <option value="powerpoint">PowerPoint Presentation</option>
                            <option value="csv">CSV Data</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Include Charts</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" checked> Trend Charts
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" checked> Distribution Charts
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox"> Heatmaps
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox"> Performance Tables
                            </label>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" data-modal="report-modal">Cancel</button>
            <button class="btn-primary" id="generate-report-btn">
                <i class="fas fa-file-alt"></i>
                Generate Report
            </button>
        </div>
    </div>
</div>